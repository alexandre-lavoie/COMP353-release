_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{MJgZ:function(e,t,n){"use strict";var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("q1tI")),i=(0,a(n("8/g6")).default)(r.default.createElement("path",{d:"M8 10H5V7H3v3H0v2h3v3h2v-3h3v-2zm10 1c1.66 0 2.99-1.34 2.99-3S19.66 5 18 5c-.32 0-.63.05-.91.14.57.81.9 1.79.9 2.86s-.34 2.04-.9 2.86c.28.09.59.14.91.14zm-5 0c1.66 0 2.99-1.34 2.99-3S14.66 5 13 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm6.62 2.16c.83.73 1.38 1.66 1.38 2.84v2h3v-2c0-1.54-2.37-2.49-4.38-2.84zM13 13c-2 0-6 1-6 3v2h12v-2c0-2-4-3-6-3z"}),"GroupAdd");t.default=i},"hYQ+":function(e,t,n){"use strict";var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("q1tI")),i=(0,a(n("8/g6")).default)(r.default.createElement("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"}),"AttachMoney");t.default=i},i5Ti:function(e,t,n){"use strict";n.r(t);var a=n("o0o1"),r=n.n(a),i=n("HaE+"),c=n("rePB"),s=n("KQm4"),o=n("ODXe"),u=n("q1tI"),l=n.n(u),d=n("R/WZ"),p=n("tRbT"),f=n("30+C"),b=n("50B7"),m=n("ofer"),v=n("csfp"),O=n("9jPY"),g=n("PsDL"),h=n("gd/W"),j=n("jjAL"),w=n("JQEk"),y=n("Z3vd"),x=n("79Xs"),_=n("wb2y"),k=n("cBaE"),S=n("eD//"),P=n("tVbE"),q=n("IsqK"),E=n("SLcR"),C=n("469l"),D=n("y9ZN"),M=n.n(D),T=n("80KL"),N=n.n(T),H=n("Rme4"),R=n.n(H),A=n("MJgZ"),J=n.n(A),z=n("ZuSV"),B=n.n(z),I=n("hYQ+"),K=n.n(I),L=n("nOHt"),V=n("JSsD"),Z=n("9Koi"),Q=n("xM+5"),X=n("VH89"),Y=n("rcHE"),F=n("apO0"),W=l.a.createElement;function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=Object(d.a)({media:{height:500},panel:{marginTop:V.a.spacing(4)},mapPanel:{marginTop:V.a.spacing(4),paddingBottom:V.a.spacing(0)},map:{padding:V.a.spacing(0)},nested:{paddingLeft:V.a.spacing(4)},success:{background:"#4caf50",color:"white"},error:{background:"#f44336",color:"white"}});t.default=function(e){var t=Object(k.e)(),n=Object(o.a)(t,2),a=n[0],c=n[1],d=Object(Z.a)().t,D=Object(L.useRouter)(),T=$(),H=Object(u.useState)(null),A=H[0],z=H[1],I=Object(u.useState)(),G=I[0],ee=I[1],te=Object(u.useState)([]),ne=te[0],ae=te[1],re=Object(u.useState)(""),ie=re[0],ce=re[1],se=Object(u.useState)(""),oe=se[0],ue=se[1],le=Object(u.useState)(!1),de=le[0],pe=le[1],fe=Object(u.useState)(!1),be=fe[0],me=fe[1],ve=Object(u.useState)(!1),Oe=ve[0],ge=ve[1],he=Object(u.useState)(null),je=he[0],we=he[1],ye=c&&c.roles&&null!=c.roles.find((function(e){return"admin"==e})),xe=l.a.useState(null),_e=Object(o.a)(xe,2),ke=_e[0],Se=_e[1],Pe=function(){var e=[];return A.buildings.forEach((function(t){return e.push.apply(e,Object(s.a)(t.condos?t.condos:[]))})),e.map((function(t){return U(U({},e),{},{id:t.id,name:"condo ".concat(t.building_id,"-").concat(t.number),image:t.image})}))},qe=function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!A){e.next=5;break}return e.next=3,Object(k.a)("associations/index","delete",{id:A.id});case 3:(t=e.sent).status?(ue("Association deleted"),D.push("/associations")):(console.log(t),ce("Something went wrong"));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=6;break}return t=je?je.id:G.find((function(e){return e.user_id==c.id})).user_id,e.next=4,Object(k.a)("associations/members","delete",{id:t});case 4:"OK"==e.sent.status?(ee(G.filter((function(e){return e.user_id!=c.id}))),we(null)):ce("Something went wrong");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c||!G){e.next=5;break}return e.next=3,Object(k.a)("associations/members","create",{association_id:A.id,user_id:c.id,type:"member"});case 3:(t=e.sent).id?"1"==t.active?ee([].concat(Object(s.a)(G),[t])):we(t):ue("Request sent");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)("associations/index","update",{id:A.id,active:1});case 2:e.sent.id?(ge(!0),ue("Association activated")):ce("Something went wrong"),Se(null);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Object(i.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=5;break}return e.next=3,Object(k.a)("posts/index","create",U(U({},t),{},{type:"post",association_ids:[A.id]}));case 3:(n=e.sent).id?(ae([n].concat(Object(s.a)(ne))),ue("Posted")):ce("Something went wrong");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Te=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)("posts/index","delete",{id:t.id});case 2:"OK"==e.sent.status?(ae(ne.filter((function(e){return e!=t}))),ue("Post deleted")):ce("Permission required");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&(D.query.id||D.push("/associations"),Ae(),Re(),He());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=Object(i.a)(r.a.mark((function e(){var t,n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.query.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(k.a)("associations/posts","find",{association_id:D.query.id});case 4:(t=e.sent).association_posts&&(n=t.association_posts,a=n.map((function(e){return e.post})),ae(a.reverse()));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Object(i.a)(r.a.mark((function e(){var t,n,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.query.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(k.a)("associations/members","find",{association_id:D.query.id});case 4:(t=e.sent).association_members&&(n=t.association_members,a=n.filter((function(e){return"1"==e.active})),i=n.find((function(e){return e.user_id==c.id&&"1"!=e.active})),console.log(a),ee(a),we(i));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(i.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D.query.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(k.a)("associations/index","find",{id:D.query.id});case 4:(t=e.sent).associations&&t.associations[0]?("1"==(n=t.associations[0]).active||ye||D.push("/associations"),z(n),ge("1"==n.active)):(ce("Association not found"),D.push("/associations"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.useEffect)((function(){if(c&&G){var e=G.find((function(e){return e.user_id==c.id}));pe(null!=e&&"1"==e.active),me(null!=e&&"president"==e.type)}}),[G,c]),Object(u.useEffect)((function(){a||c||D.push("/")}),[c,a]),Object(u.useEffect)((function(){Ne()}),[c]),Object(k.d)(He,k.b),W(F.a,{title:A?"".concat(A.name," | CON"):"CON",loading:a||null==A},W(p.a,{container:!0,spacing:4},W(p.a,{item:!0,container:!0,direction:"column",spacing:3,xs:12,md:8},W(p.a,{item:!0},W(f.a,{variant:"outlined",square:!0},W(b.a,{title:W(p.a,{container:!0,alignItems:"center",spacing:2},W(p.a,{item:!0},W(m.a,{variant:"h2",color:"textPrimary"},A?A.name:"Association")),A&&!Oe?W(p.a,{item:!0},W(v.a,{placement:"bottom-end",arrow:!0,title:"This condo will not be visible until an admin approves it"},W(O.a,{size:"small",label:"Unlisted"}))):""),action:ye||be?W(l.a.Fragment,null,W(g.a,{onClick:function(e){return Se(e.currentTarget)}},W(B.a,null)),W(h.a,{anchorEl:ke,keepMounted:!0,open:Boolean(ke),onClose:function(){return Se(null)}},A&&!Oe?W(j.a,{onClick:De},"Activate"):"",W(j.a,{onClick:function(){A&&D.push("/associations/edit?id=".concat(A.id))}},"Edit"),W(j.a,{onClick:qe},"Delete"))):""}),W(w.a,{in:A&&Oe},W(p.a,{container:!0,alignItems:"center",justify:"space-between"},W(p.a,{item:!0},W(b.a,{avatar:W(C.a,null,W(J.a,null)),title:de?"You're a member":"Join group to post"})),W(p.a,{item:!0},W(y.a,{style:{margin:V.a.spacing(2)},variant:"contained",color:"primary",onClick:Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de||je?Ee():Ce();case 1:case"end":return e.stop()}}),e)})))},de?"Leave":je?"Cancel Request":"Join")))))),de?W(p.a,{item:!0},W(Q.a,{onSend:Me})):"",W(x.a,{open:""!=ie,autoHideDuration:6e3,onClose:function(){return ce("")},message:ie,ContentProps:{classes:{root:T.error}}}),W(x.a,{open:""!=oe,autoHideDuration:6e3,onClose:function(){return ue("")},message:oe,ContentProps:{classes:{root:T.success}}}),W(p.a,{item:!0,container:!0,direction:"column",spacing:3},W(X.a,{me:c,posts:ne,onDelete:Te}))),W(p.a,{item:!0,xs:12,md:4},W(f.a,{variant:"outlined",square:!0},W(S.a,null,W(P.a,null,W(E.a,null,W(C.a,null,W(K.a,null))),W(q.a,{primary:d("Budget"),secondary:A&&A.budget?A.budget.replace(/\B(?=(\d{3})+(?!\d))/g,","):0})))),W(f.a,{variant:"outlined",square:!0,className:T.panel},W(S.a,null,W(P.a,null,W(E.a,null,W(C.a,null,W(N.a,null))),W(q.a,{primary:d("Properties"),secondary:A&&A.buildings?"".concat(A.buildings.length," buildings - ").concat(Pe().length," condos"):0})),A&&A.buildings?W(l.a.Fragment,null,W(_.a,null),W(Y.a,{heads:Pe(),icon:W(R.a,null),onSelect:function(e){return D.push("/condos/condo?id=".concat(e))}})):"")),W(f.a,{variant:"outlined",square:!0,className:T.panel},W(S.a,null,W(P.a,null,W(E.a,null,W(C.a,null,W(M.a,null))),W(q.a,{primary:d("Members"),secondary:A&&G?G.length:0})),A&&G?W(l.a.Fragment,null,W(_.a,null),W(Y.a,{heads:G.map((function(e){return{id:e.user_id,name:e.user?e.user.name:"",subname:e.type,image:e.image}})),onSelect:function(e){return D.push("/users/user?id=".concat(e))}})):"")))))}},"tqx+":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/associations/association",function(){return n("i5Ti")}])}},[["tqx+",0,2,4,10,1,3,5,6,7,8,11,9,13]]]);