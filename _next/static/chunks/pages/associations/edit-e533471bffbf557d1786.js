_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"+HS/":function(e,t,n){"use strict";n.r(t);var r=n("o0o1"),a=n.n(r),i=n("HaE+"),c=n("rePB"),o=n("ODXe"),s=n("q1tI"),u=n.n(s),l=n("nOHt"),f=n("9Koi"),p=n("R/WZ"),d=n("tRbT"),m=n("kKAo"),b=n("ofer"),O=n("r9w1"),h=n("ADg1"),j=n("1AYd"),v=n("cVXz"),g=n("jjAL"),y=n("Z3vd"),w=n("79Xs"),x=n("cBaE"),k=n("apO0"),S=n("ub5l"),P=u.a.createElement;function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=Object(p.a)((function(e){return{mainContainer:{width:"100%",height:"100vh"},loginContainer:{padding:e.spacing(3)}}}));t.default=function(e){var t=Object(x.e)(),n=Object(o.a)(t,2),r=n[0],u=n[1],p=Object(l.useRouter)(),D=_(),C=Object(f.a)().t,A=Object(s.useState)(null),N=A[0],I=A[1],U=Object(s.useState)(""),q=U[0],F=U[1],H=Object(s.useState)([]),M=H[0],X=H[1],B=Object(s.useState)(null),L=B[0],R=B[1],T=Object(s.useState)([]),z=T[0],W=T[1],Z=Object(s.useState)([]),J=Z[0],K=Z[1],$=Object(s.useState)(""),V=$[0],Y=$[1],G=Object(s.useState)(""),Q=G[0],ee=G[1],te=Object(s.useState)(!1),ne=te[0],re=te[1],ae=Object(s.useState)(null),ie=ae[0],ce=ae[1],oe=u&&u.roles&&null!=u.roles.find((function(e){return"admin"==e})),se=function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)("associations/index","update",E(E({},N),{},{image:ie}));case 2:(t=e.sent).id?(ue(),F("Condo updated"),p.push("/associations/association?id=".concat(N.id))):(console.log(t),F("Something went wrong!"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=M.filter((function(e){return null==z.find((function(t){return t==e.user}))})),n=z.filter((function(e){return null==M.map((function(e){return e.user})).find((function(t){return e==t}))})),t&&0!=t.length&&t.forEach(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)("associations/members","delete",{id:t.id});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q==L.user_id){e.next=9;break}return e.next=6,Object(x.a)("associations/members","delete",{id:L.id});case 6:return n.push(L.user),e.next=9,Object(x.a)("associations/members","create",{user_id:Q,association_id:N.id,type:"president"});case 9:n&&0!=n.length&&n.forEach(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)("associations/members","create",{user_id:t.id,association_id:N.id,type:"member"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.query.id||p.push("/associations"),e.next=3,Object(x.a)("associations/index","find",{id:p.query.id});case 3:(t=e.sent).associations&&t.associations[0]?(n=t.associations[0],console.log(n),I(n)):(F("Association not found"),p.push("/"));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)("associations/members","find",{association_id:p.query.id});case 2:(t=e.sent).association_members&&(n=t.association_members,X(n),W(n.map((function(e){return e.user}))),r=n.find((function(e){return e.user_id==u.id})),re(r&&"president"==r.type),i=n.find((function(e){return"president"==e.type})),R(i),ee(i?i.user_id:"-1"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.a)("users/index","find",{email:V});case 2:(t=e.sent).users&&K(t.users);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){r||u||oe||ne||p.push("/")}),[u,N,r]),Object(s.useEffect)((function(){N&&u&&fe()}),[N,u]),Object(s.useEffect)((function(){u&&le()}),[u]),Object(s.useEffect)((function(){u&&pe()}),[V,u]),P(k.a,{center:!0,title:"Edit Association | CON",loading:r},P(d.a,{className:D.mainContainer,container:!0,direction:"column",alignItems:"center",justify:"center",spacing:3},P(d.a,{item:!0},P(m.a,null,P(d.a,{className:D.loginContainer,container:!0,direction:"column",justify:"center",spacing:3},P(d.a,{item:!0},P(b.a,{variant:"h4"},"Edit group",N?" ".concat(N.name):" unknown")),P(d.a,{item:!0},P(O.a,{fullWidth:!0,label:C("Name"),name:"name",value:N?N.name:"",onChange:function(e){I(E(E({},N),{},Object(c.a)({},e.target.name,e.target.value)))}})),P(S.a,{label:"Members",activeUsers:z,searchUsers:J,onChange:Y,setActiveUsers:W}),P(d.a,{item:!0},P(h.a,{fullWidth:!0},P(j.a,null,"President"),P(v.a,{value:Q||"",onChange:function(e){return ee(e.target.value)}},z&&0!=z.length?z.map((function(e,t){return P(g.a,{value:e.id,key:t},e.name)})):""))),P(d.a,{item:!0,container:!0,spacing:2},P(d.a,{item:!0},P(y.a,{variant:"contained",color:"primary",component:"label"},"Image",P("input",{hidden:!0,type:"file",accept:"image/png, image/jpeg",onChange:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files[0],ce(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}))),P(d.a,{item:!0},P(y.a,{variant:"contained",color:"secondary",onClick:se},C("Save group")))))))),P(w.a,{open:""!=q,autoHideDuration:6e3,onClose:function(){return F("")},message:q}))}},LAZ6:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/associations/edit",function(){return n("+HS/")}])},ub5l:function(e,t,n){"use strict";var r=n("wx14"),a=n("rePB"),i=n("q1tI"),c=n.n(i),o=n("tRbT"),s=n("r9w1"),u=n("Ff2n"),l=(n("17x9"),n("iuhU")),f=n("H2TA"),p=n("NqtD");function d(e){var t,n,r;return t=e,n=0,r=1,e=(Math.min(Math.max(n,t),r)-n)/(r-n),e=(e-=1)*e*e+1}var m=i.forwardRef((function(e,t){var n,a=e.classes,c=e.className,o=e.color,s=void 0===o?"primary":o,f=e.disableShrink,m=void 0!==f&&f,b=e.size,O=void 0===b?40:b,h=e.style,j=e.thickness,v=void 0===j?3.6:j,g=e.value,y=void 0===g?0:g,w=e.variant,x=void 0===w?"indeterminate":w,k=Object(u.a)(e,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),S={},P={},D={};if("determinate"===x||"static"===x){var E=2*Math.PI*((44-v)/2);S.strokeDasharray=E.toFixed(3),D["aria-valuenow"]=Math.round(y),"static"===x?(S.strokeDashoffset="".concat(((100-y)/100*E).toFixed(3),"px"),P.transform="rotate(-90deg)"):(S.strokeDashoffset="".concat((n=(100-y)/100,n*n*E).toFixed(3),"px"),P.transform="rotate(".concat((270*d(y/70)).toFixed(3),"deg)"))}return i.createElement("div",Object(r.a)({className:Object(l.a)(a.root,c,"inherit"!==s&&a["color".concat(Object(p.a)(s))],{indeterminate:a.indeterminate,static:a.static}[x]),style:Object(r.a)({width:O,height:O},P,h),ref:t,role:"progressbar"},D,k),i.createElement("svg",{className:a.svg,viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},i.createElement("circle",{className:Object(l.a)(a.circle,m&&a.circleDisableShrink,{indeterminate:a.circleIndeterminate,static:a.circleStatic}[x]),style:S,cx:44,cy:44,r:(44-v)/2,fill:"none",strokeWidth:v})))})),b=Object(f.a)((function(e){return{root:{display:"inline-block"},static:{transition:e.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:e.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}}),{name:"MuiCircularProgress",flip:!1})(m),O=n("+bXu"),h=n("JSsD"),j=c.a.createElement;function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=open&&e.searchUsers&&0===e.searchUsers.length;return j(o.a,{item:!0},j(O.a,{multiple:!0,style:{marginBottom:h.a.spacing(2)},filterSelectedOptions:!0,options:e.searchUsers,getOptionSelected:function(e,t){return e.name==t.name},value:e.activeUsers,onChange:function(t,n){return e.setActiveUsers(n)},loading:t,getOptionLabel:function(e){return e.name},renderInput:function(n){return j(s.a,Object(r.a)({},n,{label:e.label?e.label:"",variant:"outlined",placeholder:e.label?"Add ".concat(e.label.toLowerCase()):"Add recipient",InputProps:g(g({},n.InputProps),{},{endAdornment:j(c.a.Fragment,null,t?j(b,{color:"inherit",size:20}):null,n.InputProps.endAdornment)})}))}}))}}},[["LAZ6",0,2,4,1,3,5,6,7,8,12]]]);